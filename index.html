    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <title>Mocktail Magic</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
        <style>
            :root {
                --pink: #ffd6e7;
                --mint: #d8fff1;
                --peach: #ffe7cf;
                --blue: #d9f2ff;
                --lav: #efe3ff;
                --text: #333f4b;
                --accent: #ff7aa2;
                --accent-2: #42d1a6;
                --card: #ffffff;
                --shadow: 0 10px 30px rgba(0,0,0,0.08);
                --radius-lg: 18px;
                --radius-md: 14px;
                --radius-sm: 12px;
            }

            * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
            html, body { height: 100%; }
            body {
                margin: 0;
                font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
                color: var(--text);
                background: linear-gradient(160deg, var(--pink), var(--mint) 60%, var(--peach));
                background-attachment: fixed;
            }

            /* App frame (mobile only) */
            .app {
                max-width: 480px;
                margin: 0 auto;
                min-height: 100dvh;
                display: flex;
                flex-direction: column;
                position: relative;
                overflow: hidden;
            }

            /* Splash */
            .splash {
                position: fixed;
                inset: 0;
                display: flex;
                align-items: center;
                justify-content: center;
                background: linear-gradient(135deg, var(--pink), var(--lav));
                z-index: 9999;
                transition: opacity .4s ease;
            }
            .splash.hide { opacity: 0; pointer-events: none; }
            .splash-card {
                background: rgba(255,255,255,0.7);
                backdrop-filter: blur(8px);
                padding: 26px 28px;
                border-radius: 22px;
                box-shadow: var(--shadow);
                text-align: center;
                font-weight: 600;
            }

            /* Banner */
            .banner {
                position: sticky;
                top: 0;
                z-index: 20;
                background: linear-gradient(90deg, #ffeef6, #e8fff8, #fff6ea);
                padding: 10px 0;
                overflow: hidden;
                border-bottom-left-radius: 16px;
                border-bottom-right-radius: 16px;
                box-shadow: 0 6px 20px rgba(0,0,0,0.06);
            }
            .marquee {
                white-space: nowrap;
                display: inline-block;
                animation: scroll 14s linear infinite;
                font-weight: 600;
                color: #5a6671;
            }
            @keyframes scroll {
                0% { transform: translateX(100%); }
                100% { transform: translateX(-100%); }
            }

            /* Header */
            header {
                padding: 18px 18px 6px 18px;
            }
            .title {
                font-size: 22px;
                font-weight: 700;
                letter-spacing: 0.2px;
            }
            .subtitle {
                font-size: 13px;
                color: #6a7580;
                margin-top: 4px;
            }

            /* Menu grid */
            .grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 14px;
                padding: 12px 16px 92px 16px; /* leave space for FAB */
            }
            .card {
                background: var(--card);
                border-radius: var(--radius-lg);
                box-shadow: var(--shadow);
                overflow: hidden;
                display: flex;
                flex-direction: column;
                transition: transform .15s ease;
            }
            .card:active { transform: scale(0.99); }
        .thumb {
            height: 150px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 40px;
                position: relative;
                overflow: hidden;
            }
        .thumb img { width: 100%; height: 100%; object-fit: cover; display: block; }
            .thumb::after {
                content: "";
                position: absolute;
                inset: 0;
                background: radial-gradient(transparent, rgba(255,255,255,0.5));
            }
            .info { padding: 12px 12px 10px; }
            .name { font-weight: 600; font-size: 15px; }
        .desc { font-size: 12px; color: #71808b; margin-top: 4px; min-height: 40px; }
            .row { display: flex; align-items: center; justify-content: space-between; margin-top: 10px; }
            .price { font-weight: 700; font-size: 15px; }
            .btn {
                background: var(--text);
                color: #fff;
                padding: 10px 12px;
                border-radius: 12px;
                border: none;
                font-weight: 600;
                font-size: 13px;
                transition: transform .08s ease, box-shadow .2s ease, opacity .2s ease;
                box-shadow: 0 8px 18px rgba(0,0,0,0.12);
            }
            .btn:active { transform: translateY(1px) scale(0.98); }
            .btn-primary { background: linear-gradient(135deg, #ff8ab1, #ff6f9a); }
            .btn-mint { background: linear-gradient(135deg, #4ed6b1, #2dc6a0); }
            .btn-ghost { background: #fff; color: #26313a; box-shadow: inset 0 0 0 2px #e9eef2; }
            /* Add-to-cart success animation */
            @keyframes addedPop { 0% { transform: scale(1); } 50% { transform: scale(1.06); } 100% { transform: scale(1); } }
            .btn.added {
                background: linear-gradient(135deg, #4ed6b1, #2dc6a0);
                box-shadow: 0 10px 22px rgba(34,195,155,0.35);
                animation: addedPop .28s ease;
            }

            /* Builder card */
            .builder-card .thumb { height: 150px; }
            .builder-stage { position: relative; width: 100%; height: 100%; }
            .builder-glass { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); font-size: 52px; filter: drop-shadow(0 8px 18px rgba(0,0,0,0.12)); }
            .builder-ring { position: absolute; left: 50%; top: 50%; width: 210px; height: 210px; margin-left: -105px; margin-top: -105px; }
            @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
            .builder-caption { position:absolute; left:50%; bottom: 10px; transform: translateX(-50%); font-size: 12px; font-weight: 700; color:#344; background: rgba(255,255,255,0.85); padding: 6px 10px; border-radius: 999px; box-shadow: 0 6px 14px rgba(0,0,0,0.06); }
            /* Main card: gentle glass float, no orbit */
            .builder-card .builder-ring { animation: none; }
            @keyframes floatGlassCard { 0% { transform: translate(-50%, -50%) translateY(0); } 100% { transform: translate(-50%, -50%) translateY(-6px); } }
            .builder-card .builder-glass { animation: floatGlassCard 2.6s ease-in-out infinite alternate; }
            .ing { position: absolute; left: 50%; top: 50%; transform: rotate(var(--angle)) translate(var(--radius, 92px)) rotate(calc(var(--angle) * -1)); text-align: center; }
            @keyframes spinReverse { from { transform: translate(-50%, -50%) rotate(0deg); } to { transform: translate(-50%, -50%) rotate(-360deg); } }
            .ing-inner { display: inline-block; animation: spinReverse 20s linear infinite; transform: translate(-50%, -50%); }
            .ing .icon { font-size: 20px; display: block; transform: translateY(0); transition: transform .25s ease; }
            .ing .label { font-size: 11px; margin-top: 3px; padding: 4px 8px; border-radius: 999px; background: rgba(255,255,255,0.8); backdrop-filter: blur(6px); box-shadow: 0 6px 14px rgba(0,0,0,0.08); font-weight: 600; white-space: nowrap; max-width: 120px; overflow: hidden; text-overflow: ellipsis; }
            .ing:hover .icon { transform: translateY(-6px); }

            /* Builder page */
            .builder-wrap { padding: 14px 16px 100px; }
            .stage-card { background:#fff; border-radius: 16px; box-shadow: var(--shadow); padding: 14px; }
            .stage { position: relative; height: 420px; border-radius: 14px; background: linear-gradient(135deg,#ffe7cf,#efe3ff); overflow: hidden; }
            .stage .glass { position:absolute; left:50%; top:50%; transform: translate(-50%,-50%); font-size:64px; filter: drop-shadow(0 10px 22px rgba(0,0,0,.12)); z-index: 2; }
            .stage .ring { position:absolute; left:50%; top:50%; width: 330px; height:330px; margin-left:-165px; margin-top:-165px; animation: spin 20s linear infinite; z-index: 1; }
            .stage .ing { --radius: 150px; }
            .builder-controls { margin-top: 12px; background:#fff; border-radius: 16px; box-shadow: var(--shadow); padding: 12px; }
            .group { margin-bottom: 8px; }
            .group .label { font-size: 13px; font-weight: 700; margin-bottom: 6px; }
            .chips { display:flex; flex-wrap: wrap; gap: 8px; }
            .chip { padding: 10px 12px; border-radius: 999px; border: 2px solid #e9eef3; background:#fff; font-weight:600; font-size:13px; cursor:pointer; }
            .chip.active { border-color: #ffc2d9; background:#fff3f8; }

            /* Floating Cart */
            .fab {
                position: fixed;
                right: max(16px, calc((100vw - 480px)/2 + 16px));
                bottom: 20px;
                background: linear-gradient(135deg, #ff93b6, #ffa6c2);
                color: #fff;
                height: 56px; width: 56px;
                border-radius: 50%;
                display: flex; align-items: center; justify-content: center;
                box-shadow: 0 14px 28px rgba(255, 105, 150, 0.35);
                z-index: 40;
                border: none;
            }
            .fab:active { transform: translateY(1px) scale(0.98); }
        .fab.wiggle { animation: wiggle .4s ease; }
        @keyframes wiggle { 0%{ transform: scale(1);} 30%{ transform: scale(1.08);} 60%{ transform: scale(0.96);} 100%{ transform: scale(1);} }
            .badge {
                position: absolute; top: -4px; right: -4px;
                background: #ff3f7a;
                color: #fff; font-size: 11px; font-weight: 700;
                min-width: 20px; height: 20px; line-height: 20px; text-align: center;
                border-radius: 12px;
                box-shadow: 0 6px 14px rgba(255, 67, 125, 0.5);
                padding: 0 6px;
            }

            /* Bottom Sheet Cart */
            .sheet-backdrop {
                position: fixed; inset: 0; background: rgba(0,0,0,0.18);
                opacity: 0; pointer-events: none; transition: opacity .25s ease; z-index: 45;
            }
            .sheet { position: fixed; left: 50%; transform: translateX(-50%) translateY(100%);
                bottom: 0; width: 100%; max-width: 480px; background: #fff;
                border-top-left-radius: 20px; border-top-right-radius: 20px; box-shadow: 0 -10px 30px rgba(0,0,0,.15);
                z-index: 50; transition: transform .28s ease; }
            .sheet.open { transform: translateX(-50%) translateY(0); }
            .sheet-head { padding: 12px 16px; display:flex; align-items:center; justify-content: center; position: relative; }
            .grab { width: 44px; height: 5px; background: #e8eef3; border-radius: 6px; }
            .close-x { position: absolute; right: 12px; top: 8px; border: none; background: transparent; font-size: 22px; color: #6c7782; }
            .sheet-body { max-height: 55dvh; overflow: auto; padding: 8px 16px 16px; }
            .cart-item { display:flex; gap: 10px; align-items: center; padding: 10px 4px; border-bottom: 1px dashed #eef2f5; }
            .ci-thumb { width: 46px; height: 46px; border-radius: 12px; display:flex; align-items:center; justify-content:center; font-size: 22px; }
            .ci-info { flex: 1; }
            .ci-name { font-weight: 600; font-size: 14px; }
            .ci-sub { font-size: 12px; color: #7b8792; }
            .qty { display:flex; align-items:center; gap: 8px; }
            .qty-btn { width: 28px; height: 28px; border-radius: 10px; border:none; background:#f3f6f9; font-weight:700; font-size:16px; }
            .ci-price { font-weight: 700; }
            .sheet-foot { padding: 12px 16px 18px; border-top: 1px solid #f0f4f7; background: #fff; position: sticky; bottom: 0; }
            .tot-row { display:flex; align-items:center; justify-content: space-between; margin-bottom: 10px; }

            /* Views */
            .view { display: none; }
            .view.active { display: block; }

            /* Checkout */
            .section { padding: 14px 16px 100px; }
            .field { margin-bottom: 12px; }
            .label { font-size: 13px; margin-bottom: 6px; font-weight: 600; }
            .input { width: 100%; padding: 12px 14px; border-radius: 12px; border: 2px solid #eef2f6; background: #fff; font-size: 14px; outline: none; transition: border-color .2s ease; }
            .input:focus { border-color: #ffd0e3; }
            .pill-row { display:flex; gap: 8px; margin-top: 6px; flex-wrap: wrap; }
            .pill { padding: 10px 12px; border-radius: 999px; border: 2px solid #e9eef3; background:#fff; font-weight:600; font-size:13px; cursor: pointer; }
            .pill.active { border-color: #ffc2d9; background: #fff3f8; }
            .sticky-cta { position: fixed; left: 50%; transform: translateX(-50%); bottom: 16px; width: calc(100% - 32px); max-width: 448px; z-index: 10; }
            .checkout-list { background:#fff; border-radius: 16px; box-shadow: var(--shadow); padding: 8px 10px; margin: 8px 0 14px; }
            .co-row { display:flex; align-items:center; gap: 10px; padding: 10px 6px; border-bottom: 1px dashed #f0f4f7; }
            .co-row:last-child { border-bottom: 0; }
            .co-name { font-weight: 600; font-size: 14px; }
            .co-sub { font-size: 12px; color: #7b8792; }
            .co-line { margin-left: auto; font-weight: 700; }
            .pay-cta { margin-top: 8px; }
            .btn-upi { background: linear-gradient(135deg, #39d2a8, #22c39b); color:#fff; box-shadow: 0 10px 22px rgba(34,195,155,0.35); }
            .qr-wrap { background:#fff; border-radius: 16px; box-shadow: var(--shadow); padding: 14px; text-align:center; }
            .qr-wrap img { width: 220px; max-width: 70%; border-radius: 14px; box-shadow: 0 8px 20px rgba(0,0,0,0.08); }
            .mini { font-size: 12px; color:#6a7580; }

        /* Toggle switch */
        .switch { position: relative; width: 56px; height: 32px; display:inline-block; }
        .switch input { display:none; }
        .slider { position:absolute; inset:0; background:#e9eef3; border-radius: 999px; transition: background .2s ease; box-shadow: inset 0 0 0 2px #dfe6ec; }
        .slider::before { content:""; position:absolute; left:4px; top:4px; width:24px; height:24px; background:#fff; border-radius:50%; box-shadow: 0 4px 10px rgba(0,0,0,.12); transition: transform .2s ease; }
        .switch input:checked + .slider { background: linear-gradient(135deg, #4ed6b1, #2dc6a0); box-shadow:none; }
        .switch input:checked + .slider::before { transform: translateX(24px); }

            /* Success */
            .success {
                text-align: center; padding: 40px 16px 120px;
            }
            .big-emoji { font-size: 64px; }
            .success h2 { margin: 12px 0 6px; font-size: 22px; }
            .success p { color: #66737e; }
            .confetti { position: fixed; inset: 0; pointer-events: none; z-index: 999; overflow: hidden; }
        .boba-overlay { position: fixed; inset: 0; pointer-events: none; z-index: 998; overflow: hidden; }

            /* Utilities */
            .hide { display: none !important; }
            .soft-card { background: rgba(255,255,255,0.6); border-radius: 16px; backdrop-filter: blur(8px); padding: 10px 12px; }
            .rowc { display:flex; align-items:center; gap: 10px; }
            .muted { color: #6f7d88; }
        </style>
    </head>
    <body>
        <!-- Splash Screen -->
        <div class="splash" id="splash">
            <div class="splash-card">
                <div style="font-size:28px">üç∏</div>
                <div style="margin-top:6px">Mocktail Cloud loading...</div>
            </div>
        </div>

        <div class="app">
            <!-- Scrolling banner -->
            <div class="banner">
                <div class="marquee">‚ú® Fresh mocktails made with love ‚ú® &nbsp; ‚ú® Mocktail Magic ‚ú® &nbsp; ‚ú® By Arjun Mahadev ‚ú® &nbsp;</div>
            </div>

            <!-- Home / Menu View -->
            <div id="view-menu" class="view active">
                <header>
                    <div class="title">Mocktail Magic</div>
                    <div class="subtitle">colorful zero-proof drinks, made with love</div>
                </header>
                <div class="grid" id="menu-grid"></div>
            </div>

            <!-- Builder View -->
            <div id="view-builder" class="view">
                <header>
                    <div class="title">Make your own mocktail</div>
                    <div class="subtitle">pick pearls, milk and syrups ‚ú®</div>
                </header>
                <div class="builder-wrap">
                    <div class="stage-card">
                        <div class="stage">
                            <div class="glass">üçπ</div>
                            <div class="ring" id="builder-ring">
                                <!-- dynamic ring icons rendered by JS -->
                            </div>
                        </div>
                    </div>
                    <div style="height:10px"></div>
                    <div class="builder-controls">
                        <div class="group">
                            <div class="label">Boba pearls</div>
                            <div class="chips">
                                <button id="chip-choco" class="chip" onclick="toggleBuilderOpt('choco')">üç´ Chocolate boba</button>
                                <button id="chip-orange" class="chip" onclick="toggleBuilderOpt('orange')">üü† Orange boba</button>
                            </div>
                        </div>
                        <div class="group">
                            <div class="label">Milk</div>
                            <div class="chips">
                                <button id="chip-milk" class="chip" onclick="toggleBuilderOpt('milk')">ü•õ Add milk</button>
                            </div>
                        </div>
                        <div class="group">
                            <div class="label">Syrups (choose up to 4)</div>
                            <div class="chips">
                                <button id="chip-syr-straw" class="chip" onclick="toggleBuilderSyrup('strawberry')">üçì Strawberry</button>
                                <button id="chip-syr-blue" class="chip" onclick="toggleBuilderSyrup('blueberry')">ü´ê Blueberry</button>
                                <button id="chip-syr-lemon" class="chip" onclick="toggleBuilderSyrup('lemon')">üçã Lemon</button>
                                <button id="chip-syr-mint" class="chip" onclick="toggleBuilderSyrup('mint')">üåø Mint</button>
                            </div>
                        </div>
                        <div class="mini" id="builder-summary">Base mocktail</div>
                    </div>
                </div>
                <div class="sticky-cta">
                    <div class="row" style="gap:10px">
                        <button class="btn btn-ghost" style="flex:1" onclick="navigate('menu')">‚Üê Menu</button>
                        <button id="builder-add-btn" class="btn btn-primary" style="flex:2; padding:14px 16px; font-size:15px;" onclick="addCustomToCart()">Add to cart ‚Ä¢ ‚Çπ80</button>
                    </div>
                </div>
            </div>

            <!-- Checkout View -->
            <div id="view-checkout" class="view">
                <header>
                    <div class="title">Checkout</div>
                    <div class="subtitle">one last step before the sparkle ‚ú®</div>
                </header>
                <div class="section">
                    <div class="soft-card" style="margin-bottom:12px">
                        <div class="rowc" style="justify-content: space-between;">
                            <div class="muted" id="checkout-summary">0 items ‚Ä¢ ‚Çπ0</div>
                            <button class="btn btn-ghost" onclick="navigate('menu')">‚Üê Menu</button>
                        </div>
                    </div>

                    <div class="field">
                        <div class="label">Your Order</div>
                        <div id="checkout-cart-list" class="checkout-list"></div>
                    </div>

                    <div class="field">
                        <div class="label">Name</div>
                        <input class="input" id="name" placeholder="Your name" />
                    </div>
                    <div class="field">
                        <div class="label">Phone</div>
                        <input class="input" id="phone" placeholder="10-digit phone" inputmode="numeric" />
                    </div>
                    <div class="field">
                        <div class="label">Notes (optional)</div>
                        <textarea class="input" id="notes" rows="3" placeholder="Less ice? Extra mint?" style="resize:none"></textarea>
                    </div>
                <div class="field">
                    <div class="label">Boba pearls?</div>
                    <div class="rowc" style="justify-content: space-between;">
                        <div class="muted" id="boba-text">No</div>
                        <label class="switch" aria-label="Boba pearls toggle">
                            <input type="checkbox" id="boba-toggle" onchange="document.getElementById('boba-text').textContent = this.checked ? 'Yes' : 'No'; if(this.checked){ bobaRain(); } (function(){ const s=checkoutSummaryWithBoba(); document.getElementById('checkout-summary').textContent = `${s.count} item${s.count>1?'s':''} ‚Ä¢ ‚Çπ${s.total}`; renderCheckoutCart(); })()">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                    <div class="field">
                        <div class="label">Payment</div>
                        <div class="pill-row">
                            <button class="pill" id="pay-upi" onclick="selectPayment('UPI')">üí∏ Pay via UPI</button>
                            <button class="pill" id="pay-qr" onclick="selectPayment('QR')">üßæ Scan QR to Pay</button>
                            <button class="pill" id="pay-cash" onclick="selectPayment('CASH')">üíµ Pay at Counter</button>
                        </div>
                        <div id="upi-hint" class="muted" style="margin-top:8px; font-size:12px; display:none;">We‚Äôll open your UPI app with the amount filled in.</div>
                        <div id="upi-actions" class="pay-cta hide">
                            <button class="btn btn-upi" style="width:100%; padding:12px 14px; font-size:15px;" onclick="openUPILink()">üí∏ Pay via UPI</button>
                        </div>
                        <div id="qr-section" class="qr-wrap hide" style="margin-top:12px;">
                            <img id="qr-image" alt="UPI QR" />
                            <div style="height:8px"></div>
                            <div class="mini">UPI ID: <b id="upi-id-text"></b></div>
                            <div class="mini" id="qr-hint">Scan the QR using any UPI app to pay</div>
                            <div style="height:10px"></div>
                            <button class="btn btn-ghost" style="width:100%;" onclick="ivePaid()">‚ú® I've Paid</button>
                        </div>
                    
                    </div>
                </div>
            <div class="sticky-cta" id="sticky-cta">
                <button id="confirm-btn" class="btn btn-primary" style="width:100%; padding:14px 16px; font-size:15px;" onclick="submitOrder()">Confirm Order</button>
            </div>
            </div>

            <!-- Success View -->
            <div id="view-success" class="view">
                <div class="success">
                    <div class="big-emoji">üéâ</div>
                    <h2>yayyy! your drink‚Äôs getting ready üçπ</h2>
                    <p id="success-text">order #‚Äî will be ready soon!</p>
                    <div style="height:12px"></div>
                    <button class="btn btn-mint" onclick="goHome()">Order more</button>
                </div>
            </div>

            <!-- Bottom Sheet Cart -->
            <div class="sheet-backdrop" id="sheet-backdrop" onclick="toggleCart(false)"></div>
            <div class="sheet" id="cart-sheet" aria-hidden="true">
                <div class="sheet-head">
                    <div class="grab"></div>
                    <button class="close-x" onclick="toggleCart(false)">√ó</button>
                </div>
                <div class="sheet-body" id="cart-items"></div>
                <div class="sheet-foot">
                    <div class="tot-row">
                        <div class="muted">Total</div>
                        <div class="price" id="cart-total">‚Çπ0</div>
                    </div>
                    <button class="btn btn-primary" style="width:100%; padding:14px 16px; font-size:15px;" onclick="proceedCheckout()">Proceed to Checkout</button>
                </div>
            </div>

            <!-- Floating Cart Button -->
            <button class="fab" onclick="toggleCart(true)" aria-label="Open cart">
                üõí
                <span class="badge" id="cart-badge">0</span>
            </button>

            <!-- Confetti Container -->
            <div id="confetti" class="confetti"></div>
        <!-- Boba Rain Overlay -->
        <div id="boba" class="boba-overlay"></div>
        </div>

    <script>
        // Editable Payment constants
            const UPI_ID = '9704332315@ybl';
            const PAYEE_NAME = 'Mocktail Cloud';
            const PAYMENT_QR_URL = 'link-to-qr-image.png'; // put your QR image path here

        // Backend disabled ‚Äì orders are stored locally only.

            // Data: Drinks
            const DRINKS = [
                // Place these files in an `assets/` folder next to index.html
                { id: 'sunset', name: 'Sunset Glow üçç', desc: 'mango + pineapple + fizz', price: 80, emoji: 'üåÖ', img: 'mocktail-cloud/lemon-sparkle.png', grad: 'linear-gradient(135deg,#ffd1e6,#ffe9cf)' },
                { id: 'blue', name: 'Blue Bliss üíô', desc: 'lemonade + blue curacao + mint', price: 80, emoji: 'üíß', img: 'mocktail-cloud/blue-mint-boba.png', grad: 'linear-gradient(135deg,#d9f2ff,#e8fff8)' },
                { id: 'berry', name: 'Berry Dream üçì', desc: 'strawberry + lime + soda', price: 80, emoji: 'üçì', img: 'mocktail-cloud/berry-soda.png', grad: 'linear-gradient(135deg,#ffe3f0,#efe3ff)' },
                { id: 'minty', name: 'Minty Magic üåø', desc: 'lemon + mint + soda', price: 80, emoji: 'üåø', img: 'mocktail-cloud/mojito-mint.png', grad: 'linear-gradient(135deg,#d8fff1,#eafcff)' },
                { id: 'choco-boba', name: 'Chocolate Boba üç´', desc: 'rich cocoa + pearls', price: 120, emoji: 'üç´', img: 'mocktail-cloud/chocolate boba.png', grad: 'linear-gradient(135deg,#f5e6d3,#ffe0e6)' },
                { id: 'milk-boba', name: 'Milky Boba üßã', desc: 'classic milk tea + pearls', price: 120, emoji: 'üßã', img: 'mocktail-cloud/milk-boba.jpg', grad: 'linear-gradient(135deg,#f7efe6,#e8fff8)' },
            ];

            // State
            const CART_KEY = 'mm_cart';
            const ORDERS_KEY = 'mm_orders';
            let paymentMethod = null; // 'UPI' | 'QR' | 'CASH'

            const $ = sel => document.querySelector(sel);
            const $$ = sel => Array.from(document.querySelectorAll(sel));

            // Builder state
            const builderState = {
                choco: false,
                orange: false,
                milk: false,
                syrups: new Set()
            };

            function initBuilder() {
                // reset
                builderState.choco = false;
                builderState.orange = false;
                builderState.milk = false;
                builderState.syrups = new Set();
                ['chip-choco','chip-orange','chip-milk','chip-syr-straw','chip-syr-blue','chip-syr-lemon','chip-syr-mint']
                  .forEach(id => document.getElementById(id)?.classList.remove('active'));
                renderBuilderRing();
                updateBuilderSummary();
            }

            function toggleBuilderOpt(key) {
                builderState[key] = !builderState[key];
                document.getElementById('chip-' + (key === 'choco' ? 'choco' : key === 'orange' ? 'orange' : 'milk'))?.classList.toggle('active', builderState[key]);
                renderBuilderRing();
                updateBuilderSummary();
            }

            function toggleBuilderSyrup(s) {
                if (builderState.syrups.has(s)) {
                    builderState.syrups.delete(s);
                } else {
                    if (builderState.syrups.size >= 4) { toast('Max 4 syrups'); return; }
                    builderState.syrups.add(s);
                }
                const idMap = { strawberry:'chip-syr-straw', blueberry:'chip-syr-blue', lemon:'chip-syr-lemon', mint:'chip-syr-mint' };
                document.getElementById(idMap[s])?.classList.toggle('active', builderState.syrups.has(s));
                renderBuilderRing();
                updateBuilderSummary();
            }

            function renderBuilderRing() {
                const ring = document.getElementById('builder-ring');
                if (!ring) return;
                ring.innerHTML = '';
                const entries = [];
                if (builderState.choco) entries.push({ icon:'üç´', label:'Chocolate boba' });
                if (builderState.orange) entries.push({ icon:'üü†', label:'Orange boba' });
                if (builderState.milk) entries.push({ icon:'ü•õ', label:'Milk' });
                builderState.syrups.forEach(s => {
                    const map = { strawberry:['üçì','Strawberry'], blueberry:['ü´ê','Blueberry'], lemon:['üçã','Lemon'], mint:['üåø','Mint'] };
                    const [icon, name] = map[s];
                    entries.push({ icon, label: name + ' syrup' });
                });
                if (entries.length === 0) {
                    ring.innerHTML = '<div class="ing" style="--angle:0deg;"><div class="ing-inner"><span class="icon">‚ú®</span><span class="label">Add ingredients</span></div></div>';
                    return;
                }
                const step = 360 / entries.length;
                entries.forEach((e, i) => {
                    const angle = i * step;
                    const node = document.createElement('div');
                    node.className = 'ing';
                    node.style.setProperty('--angle', angle + 'deg');
                    node.innerHTML = `<div class=\"ing-inner\"><span class=\"icon\">${e.icon}</span><span class=\"label\">${e.label}</span></div>`;
                    ring.appendChild(node);
                });
            }

            function getCustomPrice() {
                // Base 80; each boba +20; milk +10; each syrup +10
                let price = 80;
                if (builderState.choco) price += 20;
                if (builderState.orange) price += 20;
                if (builderState.milk) price += 10;
                price += builderState.syrups.size * 10;
                return price;
            }

            function getCustomName() {
                const parts = [];
                if (builderState.choco) parts.push('choco boba');
                if (builderState.orange) parts.push('orange boba');
                if (builderState.milk) parts.push('milk');
                if (builderState.syrups.size) parts.push([...builderState.syrups].join('+'));
                const detail = parts.length ? ' (' + parts.join(', ') + ')' : '';
                return 'Custom Mocktail' + detail;
            }

            function updateBuilderSummary() {
                const price = getCustomPrice();
                const name = getCustomName();
                const summary = document.getElementById('builder-summary');
                if (summary) summary.textContent = `${name} ‚Ä¢ ‚Çπ${price}`;
                const btn = document.getElementById('builder-add-btn');
                if (btn) btn.textContent = `Add to cart ‚Ä¢ ‚Çπ${price}`;
            }

            function addCustomToCart() {
                const price = getCustomPrice();
                const name = getCustomName();
                const cart = getCart();
                const id = 'custom-' + btoa(unescape(encodeURIComponent(name))).slice(0,8);
                const existing = cart.find(i => i.id === id && i.unitPrice === price);
                if (existing) existing.qty += 1; else cart.push({ id, qty: 1, customName: name, unitPrice: price });
                setCart(cart);
                updateCartBadge();
                animateCartBadge();
                toggleCart(true);
            }

            // Splash
            window.addEventListener('load', () => {
                setTimeout(() => { $('#splash').classList.add('hide'); }, 900);
                init();
            });

            function init() {
                // Clear persisted cart on a fresh tab/session so users don't see old items
                if (!sessionStorage.getItem('mm_cart_session_started')) {
                    setCart([]);
                    sessionStorage.setItem('mm_cart_session_started', '1');
                }
                renderMenu();
                updateCartBadge();
            }

            // SPA Navigation
            function navigate(view) {
                $$('.view').forEach(v => v.classList.remove('active'));
                if (view === 'menu') { $('#view-menu').classList.add('active'); }
                if (view === 'checkout') { $('#view-checkout').classList.add('active'); }
                if (view === 'builder') { $('#view-builder').classList.add('active'); }
                if (view === 'success') { $('#view-success').classList.add('active'); }
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            // Menu rendering
            function renderMenu() {
                const grid = $('#menu-grid');
                grid.innerHTML = '';
                // Builder card
                const builder = document.createElement('div');
                builder.className = 'card builder-card';
                builder.innerHTML = `
                        <div class="thumb" style="background: var(--peach)">
                            <div class="builder-stage">
                                <div class="builder-glass">üçπ</div>
                            </div>
                        </div>
                        <div class="info">
                            <div class="name">Make your own mocktail</div>
                            <div class="desc">craft your drink with pearls, milk and syrups</div>
                            <div class="row">
                                <div class="price">Have fun ‚ú®</div>
                                <button class="btn btn-ghost" onclick="navigate('builder'); initBuilder();">Start</button>
                            </div>
                        </div>
                `;
                grid.appendChild(builder);
                DRINKS.forEach(d => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `
                        <div class="thumb" style="background:${d.grad}">${d.img ? `<img src="${d.img}" alt="${d.name}" onerror="console.error('Image failed:', this.src); this.onerror=null; var p=this.parentNode; if(p){ p.textContent='${d.emoji.replace(/'/g,"&#39;")}' }" loading="lazy">` : d.emoji}</div>
                        <div class="info">
                            <div class="name">${d.name}</div>
                            <div class="desc">${d.desc}</div>
                            <div class="row">
                                <div class="price">‚Çπ${d.price}</div>
                                <button class="btn btn-ghost" onclick="addToCart('${d.id}', this)">Add to Cart</button>
                            </div>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            }

            // Cart logic
            function getCart() {
                try { return JSON.parse(localStorage.getItem(CART_KEY)) || []; } catch { return []; }
            }
            function setCart(items) {
                localStorage.setItem(CART_KEY, JSON.stringify(items));
            }
        function addToCart(id, btnEl) {
                const cart = getCart();
                const drink = DRINKS.find(d => d.id === id);
                if (!drink) return;
                const existing = cart.find(i => i.id === id);
                if (existing) existing.qty += 1; else cart.push({ id, qty: 1 });
                setCart(cart);
                animateCartBadge();
                updateCartBadge();
            try { if (btnEl) flyToCartFromCard(btnEl, drink.emoji); } catch {}
            // Button "Added" micro-interaction
            if (btnEl) {
                const originalText = btnEl.textContent;
                const originalWidth = btnEl.getBoundingClientRect().width + 'px';
                btnEl.style.width = originalWidth; // prevent width jump
                btnEl.textContent = 'Added';
                btnEl.classList.add('added');
                btnEl.disabled = true;
                setTimeout(() => {
                    btnEl.classList.remove('added');
                    btnEl.textContent = 'Add to Cart';
                    btnEl.style.width = '';
                    btnEl.disabled = false;
                }, 900);
            }
            }
            function updateCartBadge() {
                const cart = getCart();
                const count = cart.reduce((a, c) => a + c.qty, 0);
                $('#cart-badge').textContent = count;
            }
            function animateCartBadge() {
                const badge = $('#cart-badge');
                badge.style.transform = 'scale(1.2)';
                badge.style.transition = 'transform .15s ease';
                setTimeout(() => badge.style.transform = 'scale(1)', 150);
            }

        // Sleek pastel micro-animation to cart
        function flyToCartFromCard(btnEl, emoji) {
            const card = btnEl.closest('.card');
            const thumb = card ? card.querySelector('.thumb') : null;
            const startEl = thumb || btnEl;
            const startRect = startEl.getBoundingClientRect();
            const fab = document.querySelector('.fab');
            const endRect = fab.getBoundingClientRect();

            // Main bubble
            const bubble = document.createElement('div');
            bubble.style.position = 'fixed';
            bubble.style.left = (startRect.left + startRect.width/2) + 'px';
            bubble.style.top = (startRect.top + startRect.height/2) + 'px';
            bubble.style.width = '18px';
            bubble.style.height = '18px';
            bubble.style.borderRadius = '50%';
            bubble.style.background = 'linear-gradient(135deg,#ffbdd4,#bdf5e6)';
            bubble.style.boxShadow = '0 8px 18px rgba(0,0,0,.15)';
            bubble.style.backdropFilter = 'blur(4px)';
            bubble.style.transform = 'translate(-50%, -50%) scale(1)';
            bubble.style.transition = 'transform 520ms cubic-bezier(.19,.7,.2,1), opacity 520ms';
            bubble.style.opacity = '1';
            bubble.style.zIndex = '10000';
            bubble.style.pointerEvents = 'none';
            document.body.appendChild(bubble);

            // Tiny sparkle trail
            for (let i = 0; i < 3; i++) {
                const p = document.createElement('div');
                p.style.position = 'fixed';
                p.style.left = (startRect.left + startRect.width/2) + 'px';
                p.style.top = (startRect.top + startRect.height/2) + 'px';
                const size = 6 + Math.random()*4;
                p.style.width = size + 'px';
                p.style.height = size + 'px';
                p.style.borderRadius = '50%';
                p.style.background = '#fff';
                p.style.boxShadow = '0 4px 12px rgba(0,0,0,.15)';
                p.style.transform = 'translate(-50%, -50%)';
                p.style.transition = `transform 540ms cubic-bezier(.2,.7,.2,1), opacity 540ms`;
                p.style.opacity = '0.9';
                p.style.zIndex = '9999';
                document.body.appendChild(p);
                const offsetX = (Math.random()*30 - 15);
                const offsetY = (Math.random()*30 - 15);
                requestAnimationFrame(() => {
                    p.style.transform = `translate(calc(-50% + ${offsetX}px), calc(-50% + ${offsetY}px))`;
                    p.style.opacity = '0';
                });
                setTimeout(() => p.remove(), 560);
            }

            const dx = (endRect.left + endRect.width/2) - (startRect.left + startRect.width/2);
            const dy = (endRect.top + endRect.height/2) - (startRect.top + startRect.height/2);
            requestAnimationFrame(() => {
                bubble.style.transform = `translate(calc(-50% + ${dx}px), calc(-50% + ${dy}px)) scale(0.6)`;
                bubble.style.opacity = '0.15';
            });
            setTimeout(() => bubble.remove(), 560);

            // Subtle wiggle on the cart
            fab.classList.add('wiggle');
            setTimeout(() => fab.classList.remove('wiggle'), 420);
        }

            // Bottom sheet
            function toggleCart(open) {
                const sheet = $('#cart-sheet');
                const backdrop = $('#sheet-backdrop');
                if (open) {
                    sheet.classList.add('open');
                    backdrop.style.opacity = '1';
                    backdrop.style.pointerEvents = 'auto';
                    renderCartSheet();
                } else {
                    sheet.classList.remove('open');
                    backdrop.style.opacity = '0';
                    backdrop.style.pointerEvents = 'none';
                }
            }
            function renderCartSheet() {
                const container = $('#cart-items');
                const cart = getCart();
                if (cart.length === 0) {
                    container.innerHTML = `<div class="muted" style="text-align:center; padding: 24px 0;">Your cart is empty ‚òÅÔ∏è</div>`;
                    $('#cart-total').textContent = '‚Çπ0';
                    return;
                }
                container.innerHTML = '';
                let total = 0;
                cart.forEach(item => {
                    const d = DRINKS.find(dr => dr.id === item.id);
                    const unit = d ? d.price : (item.unitPrice || 0);
                    const displayName = d ? d.name : (item.customName || 'Custom');
                    const line = unit * item.qty;
                    total += line;
                    const row = document.createElement('div');
                    row.className = 'cart-item';
                const thumb = d ? (d.img ? `<img src="${d.img}" alt="${displayName}" style="width:46px;height:46px;object-fit:cover;border-radius:12px;" onerror="console.error('Image failed:', this.src); this.onerror=null; var p=this.parentNode; if(p){ p.textContent='${d.emoji.replace(/'/g,"&#39;")}' }">` : d.emoji) : '‚ú®';
                const bg = d ? d.grad : 'linear-gradient(135deg,#ffe7cf,#efe3ff)';
                row.innerHTML = `
                    <div class="ci-thumb" style="background:${bg}">${thumb}</div>
                        <div class="ci-info">
                            <div class="ci-name">${displayName}</div>
                            <div class="ci-sub">‚Çπ${unit} √ó ${item.qty}</div>
                        </div>
                        <div class="qty">
                            <button class="qty-btn" aria-label="decrease" onclick="decQty('${item.id}')">‚àí</button>
                            <div>${item.qty}</div>
                            <button class="qty-btn" aria-label="increase" onclick="incQty('${item.id}')">+</button>
                        </div>
                        <div class="ci-price">‚Çπ${line}</div>
                    `;
                    container.appendChild(row);
                });
                $('#cart-total').textContent = `‚Çπ${total}`;
            }
            function incQty(id) {
                const cart = getCart();
                const it = cart.find(i => i.id === id); if (!it) return;
                it.qty += 1; setCart(cart); updateCartBadge(); renderCartSheet();
            }
            function decQty(id) {
                const cart = getCart();
                const it = cart.find(i => i.id === id); if (!it) return;
                it.qty -= 1; if (it.qty <= 0) cart.splice(cart.indexOf(it), 1);
                setCart(cart); updateCartBadge(); renderCartSheet();
            }

            // Checkout
            function proceedCheckout() {
                const cart = getCart();
                if (cart.length === 0) { toggleCart(false); return; }
                toggleCart(false);
                const { count, total } = checkoutSummaryWithBoba();
                $('#checkout-summary').textContent = `${count} item${count>1?'s':''} ‚Ä¢ ‚Çπ${total}`;
                renderCheckoutCart();
                // Set QR visible texts and image
                $('#qr-image').src = PAYMENT_QR_URL;
                $('#upi-id-text').textContent = UPI_ID;
                $('#qr-hint').textContent = `Scan the QR using any UPI app to pay ‚Çπ${total}`;
                navigate('checkout');
            }
            function renderCheckoutCart() {
                const list = $('#checkout-cart-list');
                const cart = getCart();
                if (cart.length === 0) { list.innerHTML = '<div class="mini">Your cart is empty.</div>'; return; }
                let html = '';
                let total = 0;
                cart.forEach(it => {
                    const d = DRINKS.find(dr => dr.id === it.id);
                    const price = effectivePrice(d);
                    const line = price * it.qty; total += line;
                    html += `<div class=\"co-row\"><div><div class=\"co-name\">${d.name}</div><div class=\"co-sub\">‚Çπ${price} √ó ${it.qty}</div></div><div class=\"co-line\">‚Çπ${line}</div></div>`;
                });
                html += `<div class="co-row" style="font-weight:700"><div>Total</div><div class="co-line">‚Çπ${total}</div></div>`;
                list.innerHTML = html;
            }
            function cartSummary() {
                const cart = getCart();
                let count = 0, total = 0;
                cart.forEach(it => {
                    const d = DRINKS.find(dr => dr.id === it.id);
                    count += it.qty; total += (d ? d.price : (it.unitPrice||0)) * it.qty;
                });
                return { count, total };
            }
            function effectivePrice(drink) {
                const boba = document.getElementById('boba-toggle')?.checked || false;
                const isBobaItem = drink.id === 'choco-boba' || drink.id === 'milk-boba';
                if (boba && !isBobaItem) return 100; // mocktails with boba
                return drink.price; // base price (80 for mocktails, 120 for boba drinks)
            }
            function checkoutSummaryWithBoba() {
                const cart = getCart();
                let count = 0, total = 0;
                cart.forEach(it => {
                    const d = DRINKS.find(dr => dr.id === it.id);
                    count += it.qty; total += (d ? effectivePrice(d) : (it.unitPrice||0)) * it.qty;
                });
                return { count, total };
            }
            function selectPayment(method) {
                paymentMethod = method;
                $('#pay-upi').classList.toggle('active', method === 'UPI');
                $('#pay-qr').classList.toggle('active', method === 'QR');
                $('#pay-cash').classList.toggle('active', method === 'CASH');
                $('#upi-hint').style.display = method === 'UPI' ? 'block' : 'none';
                $('#upi-actions').classList.toggle('hide', method !== 'UPI');
                $('#qr-section').classList.toggle('hide', method !== 'QR');
                // Hide confirm button if UPI or QR is chosen (since those sections have their own CTA)
                const hideConfirm = method === 'UPI' || method === 'QR';
                const cta = document.getElementById('sticky-cta');
                if (cta) cta.classList.toggle('hide', hideConfirm);
            }

            function openUPILink() {
                const { total } = cartSummary();
                const params = `pa=${encodeURIComponent(UPI_ID)}&pn=${encodeURIComponent(PAYEE_NAME)}&am=${encodeURIComponent(total)}&cu=INR&tn=${encodeURIComponent('Order Payment')}`;
                const gpay = `tez://upi/pay?${params}`; // Google Pay scheme
                const phonepe = `phonepe://pay?${params}`; // PhonePe scheme
                const generic = `upi://pay?${params}`;

                let attempted = false;
                const tryOpen = (url) => {
                    attempted = true;
                    try { window.location.href = url; } catch {}
                };

                // Attempt GPay, then PhonePe, then generic UPI
                tryOpen(gpay);
                setTimeout(() => {
                    if (!attempted) return;
                    tryOpen(phonepe);
                }, 600);
                setTimeout(() => {
                    tryOpen(generic);
                }, 1200);
                toast('Opening UPI app...');
            }

            function ivePaid() {
                if (paymentMethod !== 'QR') selectPayment('QR');
                toast('Great! We‚Äôll confirm at the counter.');
            }

            // Confirm Order
        async function submitOrder() {
                const name = $('#name').value.trim();
                const phone = $('#phone').value.replace(/\D/g,'');
                const notes = $('#notes').value.trim();
                if (!name) return toast('Please enter your name');
                if (phone.length < 10) return toast('Enter a valid 10-digit phone');
                if (!paymentMethod) return toast('Select a payment method');

                const cart = getCart();
                if (cart.length === 0) return toast('Your cart is empty');

                const items = cart.map(it => {
                    const d = DRINKS.find(x => x.id === it.id);
                    if (d) {
                        const price = effectivePrice(d);
                        return { item: d.name.replace(/ [^ ]+$/,''), qty: it.qty, price };
                    } else {
                        const price = it.unitPrice || 0;
                        const name = (it.customName || 'Custom Mocktail').replace(/ [^ ]+$/,'');
                        return { item: name, qty: it.qty, price };
                    }
                });
                const total = items.reduce((a, c) => a + c.price * c.qty, 0);
                const boba = document.getElementById('boba-toggle')?.checked || false;
                const payload = { name, phone, notes, boba, cart: items, total, payment_method: paymentMethod };

            const btn = $('#confirm-btn');
            const originalText = btn.textContent;
            btn.textContent = 'Submitting‚Ä¶';
            btn.disabled = true;

            // Save order to Firebase Firestore
            let orderId = null;
            try {
                if (window.sendOrderToFirestore) {
                    orderId = await window.sendOrderToFirestore(payload);
                } else {
                    throw new Error('Firestore not initialized');
                }
            } catch (e) {
                alert('Could not place order. Try again or choose Pay at Counter.');
                btn.textContent = originalText;
                btn.disabled = false;
                return;
            }

            // If paying via UPI, attempt to open app immediately after submission
            if (paymentMethod === 'UPI') { openUPILink(); }

            // Store order locally
            saveOrder({ id: orderId, ...payload, createdAt: new Date().toISOString() });

            // Clear cart and show success
            setCart([]); updateCartBadge();
            $('#success-text').textContent = `order #${orderId} will be ready soon!`;
            navigate('success');
            burstConfetti();

            // Reset button for next time
            btn.textContent = originalText;
            btn.disabled = false;
            }

            

            function saveOrder(order) {
                let list = [];
                try { list = JSON.parse(localStorage.getItem(ORDERS_KEY)) || []; } catch {}
                list.unshift(order);
                localStorage.setItem(ORDERS_KEY, JSON.stringify(list.slice(0, 20)));
            }

            function goHome() {
                navigate('menu');
            }

            // Tiny toast
            function toast(msg) {
                const t = document.createElement('div');
                t.textContent = msg;
                t.style.position = 'fixed'; t.style.left = '50%'; t.style.transform = 'translateX(-50%)';
                t.style.bottom = '84px'; t.style.background = '#111a'; t.style.color = '#fff'; t.style.padding = '10px 14px';
                t.style.borderRadius = '12px'; t.style.fontWeight = '600'; t.style.zIndex = '99999'; t.style.backdropFilter = 'blur(4px)';
                document.body.appendChild(t);
                setTimeout(() => { t.style.opacity = '0'; t.style.transition = 'opacity .2s'; }, 1200);
                setTimeout(() => t.remove(), 1500);
            }

            // Confetti: emoji bursts
            function burstConfetti() {
                const container = $('#confetti');
                container.innerHTML = '';
                const EMOJIS = ['üçì','ü•≠','üçç','üçã','üçâ','‚ú®','üíñ','ü´ß'];
                const count = 42;
                for (let i = 0; i < count; i++) {
                    const span = document.createElement('span');
                    span.textContent = EMOJIS[Math.floor(Math.random()*EMOJIS.length)];
                    span.style.position = 'absolute';
                    span.style.left = Math.random()*100 + 'vw';
                    span.style.top = '-10vh';
                    span.style.fontSize = (16 + Math.random()*20) + 'px';
                    const rot = (Math.random()*40 - 20) + 'deg';
                    const dur = 1200 + Math.random()*1000;
                    span.style.transition = `transform ${dur}ms cubic-bezier(.2,.6,.2,1), opacity ${dur}ms`;
                    container.appendChild(span);
                    requestAnimationFrame(() => {
                        span.style.transform = `translate(${(Math.random()*60-30)}vw, 110vh) rotate(${rot})`;
                        span.style.opacity = '0.9';
                    });
                    setTimeout(() => span.remove(), dur + 600);
                }
            }
        
        // Boba rain: colorful pearls falling from the top when boba is enabled
        function bobaRain() {
            const layer = document.getElementById('boba');
            if (!layer) return;
            const COLORS = ['#6be7ff','#ffd36b','#ff8ab1','#8ee6c9','#a98bff','#ffad6b'];
            const count = 28;
            for (let i = 0; i < count; i++) {
                const pearl = document.createElement('div');
                const size = 8 + Math.random()*8; // 8-16px
                pearl.style.position = 'absolute';
                pearl.style.left = Math.random()*100 + 'vw';
                pearl.style.top = '-8vh';
                pearl.style.width = size + 'px';
                pearl.style.height = size + 'px';
                pearl.style.borderRadius = '50%';
                pearl.style.background = COLORS[Math.floor(Math.random()*COLORS.length)];
                pearl.style.boxShadow = '0 6px 14px rgba(0,0,0,.12)';
                pearl.style.opacity = '0.95';
                const dx = (Math.random()*24 - 12);
                const dur = 3000 + Math.random()*3000; // ultra-slow fall: 3s - 6s
                pearl.style.transition = `transform ${dur}ms cubic-bezier(.2,.8,.2,1), opacity ${dur}ms`;
                layer.appendChild(pearl);
                requestAnimationFrame(() => {
                    pearl.style.transform = `translate(${dx}vw, 110vh)`;
                    pearl.style.opacity = '0.06';
                });
                setTimeout(() => pearl.remove(), dur + 900);
            }
        }

        
        </script>

    <!-- Firebase Firestore integration -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js';
        import { getFirestore, addDoc, collection, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js';

        const firebaseConfig = {
          apiKey: "AIzaSyDscdFFAQlo3oYuL1z7jdbGztWfDezXRp8",
          authDomain: "mocktail-magic.firebaseapp.com",
          projectId: "mocktail-magic",
          storageBucket: "mocktail-magic.firebasestorage.app",
          messagingSenderId: "892746214757",
          appId: "1:892746214757:web:c0b5c3a22b762e2437058c",
          measurementId: "G-NS7F6Z8S1T"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Expose helper to the global scope for the main script to use
        window.sendOrderToFirestore = async function(order) {
            const docRef = await addDoc(collection(db, 'orders'), {
                ...order,
                createdAt: serverTimestamp()
            });
            return docRef.id;
        }
    </script>
    </body>
    </html>


